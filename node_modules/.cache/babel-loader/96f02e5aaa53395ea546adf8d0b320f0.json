{"ast":null,"code":"var _jsxFileName = \"/var/www/html/quiz-react/quiz-app/dwquiz/src/QuizMain.js\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport AppContext from './libs/contextLib';\nimport LoginPage from './LoginPage';\nimport { Button } from 'react-bootstrap';\nimport { useParams, useHistory } from 'react-router-dom';\n\nconst QuizMain = () => {\n  let history = useHistory();\n  const questions = [{\n    questionText: 'What is the capital of France?',\n    answerOptions: [{\n      answerText: 'New York',\n      isCorrect: false\n    }, {\n      answerText: 'London',\n      isCorrect: false\n    }, {\n      answerText: 'Paris',\n      isCorrect: true\n    }, {\n      answerText: 'Dublin',\n      isCorrect: false\n    }]\n  }, {\n    questionText: 'Who is CEO of Tesla?',\n    answerOptions: [{\n      answerText: 'Jeff Bezos',\n      isCorrect: false\n    }, {\n      answerText: 'Elon Musk',\n      isCorrect: true\n    }, {\n      answerText: 'Bill Gates',\n      isCorrect: false\n    }, {\n      answerText: 'Tony Stark',\n      isCorrect: false\n    }]\n  }, {\n    questionText: 'The iPhone was created by which company?',\n    answerOptions: [{\n      answerText: 'Apple',\n      isCorrect: true\n    }, {\n      answerText: 'Intel',\n      isCorrect: false\n    }, {\n      answerText: 'Amazon',\n      isCorrect: false\n    }, {\n      answerText: 'Microsoft',\n      isCorrect: false\n    }]\n  }, {\n    questionText: 'How many Harry Potter books are there?',\n    answerOptions: [{\n      answerText: '1',\n      isCorrect: false\n    }, {\n      answerText: '4',\n      isCorrect: false\n    }, {\n      answerText: '6',\n      isCorrect: false\n    }, {\n      answerText: '7',\n      isCorrect: true\n    }]\n  }];\n  const {\n    video_url\n  } = useParams();\n  const {\n    isAuthenticated,\n    userData\n  } = useContext(AppContext);\n  const [currentQuestion, setCurrentQuestion] = useState(0);\n  const [showScore, setShowScore] = useState(false);\n  const [score, setScore] = useState(0);\n  const [totalScore, setTotalScore] = useState(0);\n  const [participated, setParticipated] = useState(0);\n  const [answered, setAnswered] = useState([]);\n  const [clicked, setClicked] = useState([]);\n  const [answeredCount, setAnsweredCount] = useState(0);\n  const currentVideo = video_url;\n  const [isloading, setIsLoading] = useState(true);\n  const isInitialMount = useRef(true);\n  useEffect(() => {\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        func: 'getThisVideoStatus',\n        data: {\n          user_id: userData.user_id,\n          video_id: video_url\n        }\n      })\n    };\n    fetch(\"/test/quiz_apis/post_requests.php\", requestOptions).then(response => response.json()).then(d => {\n      setIsLoading(false);\n\n      if (d.error == -1) {\n        history.push(\"/\");\n      } else {\n        if (d.error == 0) {\n          let answeredCountLocal = d.data.answer_count;\n          let scoreCountLocal = d.data.score_count;\n\n          if (scoreCountLocal !== \"\") {\n            setScore(parseInt(scoreCountLocal));\n          }\n\n          if (answeredCountLocal !== \"\") {\n            setAnsweredCount(parseInt(answeredCountLocal));\n\n            if (answeredCountLocal < questions.length) {\n              setCurrentQuestion(parseInt(answeredCountLocal));\n            } else {\n              setShowScore(true);\n            }\n          }\n        } else {\n          alert(\"Something Went wrong, please try again!\");\n        }\n      }\n    });\n    const requestOptionsTotal = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        func: 'getTotalScore',\n        data: {\n          user_id: userData.user_id\n        }\n      })\n    };\n    fetch(\"/test/quiz_apis/post_requests.php\", requestOptionsTotal).then(response => response.json()).then(d => {\n      if (!d.error) {\n        setTotalScore(d.data.score_count);\n        setParticipated(d.data.participated);\n      }\n    });\n  });\n\n  const handleAnswerOptionClick = answerOption => {\n    setClicked([...clicked, {\n      qtnindex: currentQuestion,\n      ansindex: answerOption.index\n    }]);\n\n    if (answerOption.isCorrect) {\n      setScore(score + 1);\n    }\n\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        func: 'save_answer',\n        data: {\n          user_id: userData.user_id,\n          question_id: currentQuestion + 1,\n          video_id: currentVideo,\n          answer: answerOption.index,\n          is_correct: answerOption.isCorrect\n        }\n      })\n    };\n    fetch(\"/test/quiz_apis/post_requests.php\", requestOptions).then(response => response.json()).then(d => {\n      setAnsweredCount(answeredCount + 1);\n      const nextQuestion = currentQuestion + 1;\n      setAnswered([...answered, currentQuestion]);\n\n      if (nextQuestion < questions.length) {\n        setTimeout(function () {\n          setCurrentQuestion(nextQuestion);\n        }, 1000);\n      } else {\n        setTimeout(function () {\n          setShowScore(true);\n        }, 1000);\n      }\n    });\n  };\n\n  const AnswerButton = answerOption => {\n    let chkvarient = \"secondary\";\n\n    if (answered.indexOf(currentQuestion) > -1) {\n      if (answerOption.isCorrect) {\n        chkvarient = \"success\";\n      } else {\n        clicked.map(v => {\n          if (v.qtnindex === currentQuestion) {\n            if (v.ansindex === answerOption.index) {\n              chkvarient = \"danger\";\n            }\n          }\n        });\n      }\n    } else {\n      chkvarient = \"secondary\";\n    }\n\n    return /*#__PURE__*/React.createElement(Button, {\n      variant: chkvarient,\n      className: \"mb-2 w-100\",\n      onClick: () => handleAnswerOptionClick(answerOption),\n      disabled: answered.indexOf(currentQuestion) > -1 ? \"disabled\" : \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }, \" \", answerOption.answerText, \" \");\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, !isAuthenticated ? /*#__PURE__*/React.createElement(LoginPage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 33\n    }\n  }) : isloading ? /*#__PURE__*/React.createElement(React.Fragment, null, \" Please Wait., Loading..!\") : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"main col-md-6 d-flex align-items-center justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }, showScore ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-12 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 33\n    }\n  }, \"You scored \", score, \" out of \", questions.length), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 33\n    }\n  }, \"Participated in \", participated), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 33\n    }\n  }, \"Total scored \", totalScore))) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-12 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 41\n    }\n  }, \"Question \", currentQuestion + 1), \"/\", questions.length), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 37\n    }\n  }, questions[currentQuestion].questionText)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 33\n    }\n  }, questions[currentQuestion].answerOptions.map((answerOption, i) => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-100\",\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(AnswerButton, Object.assign({\n    index: i\n  }, answerOption, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 72\n    }\n  })))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 21\n    }\n  })));\n};\n\nexport default QuizMain;","map":{"version":3,"sources":["/var/www/html/quiz-react/quiz-app/dwquiz/src/QuizMain.js"],"names":["React","useState","useEffect","useContext","AppContext","LoginPage","Button","useParams","useHistory","QuizMain","history","questions","questionText","answerOptions","answerText","isCorrect","video_url","isAuthenticated","userData","currentQuestion","setCurrentQuestion","showScore","setShowScore","score","setScore","totalScore","setTotalScore","participated","setParticipated","answered","setAnswered","clicked","setClicked","answeredCount","setAnsweredCount","currentVideo","isloading","setIsLoading","isInitialMount","useRef","requestOptions","method","headers","body","JSON","stringify","func","data","user_id","video_id","fetch","then","response","json","d","error","push","answeredCountLocal","answer_count","scoreCountLocal","score_count","parseInt","length","alert","requestOptionsTotal","handleAnswerOptionClick","answerOption","qtnindex","ansindex","index","question_id","answer","is_correct","nextQuestion","setTimeout","AnswerButton","chkvarient","indexOf","map","v","i"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport AppContext from './libs/contextLib';\nimport LoginPage from './LoginPage';\nimport { Button } from 'react-bootstrap';\nimport { useParams, useHistory } from 'react-router-dom';\nconst QuizMain = () => {\n    let history = useHistory();\n    const questions = [\n        {\n            questionText: 'What is the capital of France?',\n            answerOptions: [\n                { answerText: 'New York', isCorrect: false },\n                { answerText: 'London', isCorrect: false },\n                { answerText: 'Paris', isCorrect: true },\n                { answerText: 'Dublin', isCorrect: false },\n            ],\n        },\n        {\n            questionText: 'Who is CEO of Tesla?',\n            answerOptions: [\n                { answerText: 'Jeff Bezos', isCorrect: false },\n                { answerText: 'Elon Musk', isCorrect: true },\n                { answerText: 'Bill Gates', isCorrect: false },\n                { answerText: 'Tony Stark', isCorrect: false },\n            ],\n        },\n        {\n            questionText: 'The iPhone was created by which company?',\n            answerOptions: [\n                { answerText: 'Apple', isCorrect: true },\n                { answerText: 'Intel', isCorrect: false },\n                { answerText: 'Amazon', isCorrect: false },\n                { answerText: 'Microsoft', isCorrect: false },\n            ],\n        },\n        {\n            questionText: 'How many Harry Potter books are there?',\n            answerOptions: [\n                { answerText: '1', isCorrect: false },\n                { answerText: '4', isCorrect: false },\n                { answerText: '6', isCorrect: false },\n                { answerText: '7', isCorrect: true },\n            ],\n        },\n    ];\n    const { video_url } = useParams();\n    const { isAuthenticated, userData } = useContext(AppContext);\n    const [currentQuestion, setCurrentQuestion] = useState(0);\n    const [showScore, setShowScore] = useState(false);\n    const [score, setScore] = useState(0);\n    const [totalScore, setTotalScore] = useState(0);\n    const [participated, setParticipated] = useState(0);\n    const [answered, setAnswered] = useState([]);\n    const [clicked, setClicked] = useState([]);\n    const [answeredCount, setAnsweredCount] = useState(0);\n    const currentVideo = video_url;\n    const [isloading, setIsLoading] = useState(true);\n    const isInitialMount = useRef(true);\n\n\n    useEffect(() => {\n        const requestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                func: 'getThisVideoStatus', data: {\n                    user_id: userData.user_id,\n                    video_id: video_url\n                }\n            })\n        };\n        fetch(\"/test/quiz_apis/post_requests.php\", requestOptions).then(response => response.json())\n            .then(d => {\n                setIsLoading(false);\n                if (d.error == -1) {\n                    history.push(\"/\");\n                } else {\n                    if (d.error == 0) {\n                        let answeredCountLocal = d.data.answer_count;\n                        let scoreCountLocal = d.data.score_count;\n\n                        if (scoreCountLocal !== \"\") {\n                            setScore(parseInt(scoreCountLocal));\n                        }\n                        if (answeredCountLocal !== \"\") {\n                            setAnsweredCount(parseInt(answeredCountLocal));\n                            if (answeredCountLocal < questions.length) {\n                                setCurrentQuestion(parseInt(answeredCountLocal));\n                            } else {\n                                setShowScore(true);\n                            }\n                        }\n                    } else {\n                        alert(\"Something Went wrong, please try again!\");\n                    }\n                }\n            });\n        const requestOptionsTotal = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                func: 'getTotalScore', data: {\n                    user_id: userData.user_id\n                }\n            })\n        };\n        fetch(\"/test/quiz_apis/post_requests.php\", requestOptionsTotal).then(response => response.json())\n            .then(d => {\n                if (!d.error) {\n                    setTotalScore(d.data.score_count);\n                    setParticipated(d.data.participated);\n                }\n            });\n    });\n\n    const handleAnswerOptionClick = (answerOption) => {\n        setClicked([...clicked, { qtnindex: currentQuestion, ansindex: answerOption.index }]);\n        if (answerOption.isCorrect) {\n            setScore(score + 1);\n        }\n\n        const requestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                func: 'save_answer', data: {\n                    user_id: userData.user_id,\n                    question_id: currentQuestion + 1,\n                    video_id: currentVideo,\n                    answer: answerOption.index,\n                    is_correct: answerOption.isCorrect\n                }\n            })\n        };\n        fetch(\"/test/quiz_apis/post_requests.php\", requestOptions).then(response => response.json())\n            .then(d => {\n                setAnsweredCount(answeredCount + 1);\n                const nextQuestion = currentQuestion + 1;\n                setAnswered([...answered, currentQuestion]);\n                if (nextQuestion < questions.length) {\n                    setTimeout(function () { setCurrentQuestion(nextQuestion); }, 1000);\n                } else {\n                    setTimeout(function () { setShowScore(true); }, 1000);\n                }\n            });\n    };\n\n\n    const AnswerButton = (answerOption) => {\n        let chkvarient = \"secondary\";\n        if (answered.indexOf(currentQuestion) > -1) {\n            if (answerOption.isCorrect) {\n                chkvarient = \"success\";\n            } else {\n                clicked.map(v => {\n                    if (v.qtnindex === currentQuestion) {\n                        if (v.ansindex === answerOption.index) {\n                            chkvarient = \"danger\"\n                        }\n                    }\n                });\n            }\n\n        } else {\n            chkvarient = \"secondary\"\n        }\n        return (\n            <Button variant={chkvarient} className=\"mb-2 w-100\" onClick={() => handleAnswerOptionClick(answerOption)} disabled={(answered.indexOf(currentQuestion) > -1) ? \"disabled\" : \"\"}> {answerOption.answerText} </Button>\n        );\n    }\n    return (\n        <>\n            {!isAuthenticated ? <LoginPage /> : isloading ? <> Please Wait., Loading..!</> :\n                <div className='row w-100'>\n                    <div className='col-md-3'></div>\n                    <div className='main col-md-6 d-flex align-items-center justify-content-center'>\n\n                        {showScore ? (<>\n                            <div className='col-md-12 text-center'>\n                                <p>You scored {score} out of {questions.length}</p>\n                                <p>Participated in {participated}</p>\n                                <p>Total scored {totalScore}</p>\n                            </div>\n                        </>) : (<>\n                            <>\n                                <div className='col-md-12 mb-2'>\n                                    <div className=''>\n                                        <span>Question {currentQuestion + 1}</span>/{questions.length}\n                                    </div>\n                                    <div className=''>{questions[currentQuestion].questionText}</div>\n                                </div>\n                                <div className='col-md-12'>\n                                    {questions[currentQuestion].answerOptions.map((answerOption, i) => (\n                                        <div className=\"w-100\" key={i}><AnswerButton index={i} {...answerOption} /></div>\n                                    ))}\n                                </div>\n                            </>\n                        </>)}\n                    </div>\n                    <div className='col-md-3'></div>\n                </div>\n            }\n        </>\n    );\n}\nexport default QuizMain;"]},"metadata":{},"sourceType":"module"}